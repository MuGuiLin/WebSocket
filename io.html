<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <!-- <script src='http://cdn.bootcss.com/socket.io/1.3.7/socket.io.js'></script> -->
    <script src="https://cdn.bootcss.com/socket.io/2.2.0/socket.io.js"></script>

</head>

<body>

    <input type="text" id="text">
    <button id="send">发送</button>

    <h1 id="msg">socket.io</h1>

    <script>
        window.onload = function (params) {

            var socket = io('ws://10.0.3.69:8442');

            // var socket = io('https://ciiedev.smgtech.net:8442');

            socket.on('init', function (data) {
                console.log(data);
                document.querySelector('#msg').innerHTML += data;
                socket.emit('initOK', { back: '我是前端返回来的数据！！！' });
            });

            socket.on('initOK', function (data) {
                console.log('---------------------------------------------------------', data);
            });
            

            // var socket = io('ws://10.0.3.69:8442');

            // // var socket = io('https://ciiedev.smgtech.net:8442');

            // socket.on('new_msg', function (data) {

            //     console.log(data);

            //     document.querySelector('#msg').innerHTML += data;

            //     socket.emit('initOK', { back: '我是前端返回来的数据！！！' });

            // });


            // socket.on('initOK', function (data) {
            //     console.log(data);
            //     document.querySelector('#msg').innerHTML += data;
            // });


            document.querySelector('#send')['onclick'] = () => {
                let text = document.querySelector('#text').value;
                if (text) {
                    socket.emit('initOK', {data: text});
                } else {
                    alert('内容不能为空！！');
                }
            };



            //原生JS  WebSocket

            // let ws = new WebSocket("ws://10.0.3.69:8442");

            // ws.onmessage = function (o) {
            //     console.log(o);

            //     ws.send('这是向服务端发送的数据！');
            // };

            // ws.onclose = function (evt) {
            //     console.log('第3方已经关闭连接！')
            // };

            // ws.onerror = function (evt) {
            //     console.log("第3方连接产生异常！");
            // };


            // const socket = new WebSocket('ws://localhost:8080');

            // // Connection opened
            // socket.addEventListener('open', function (event) {
            //     socket.send('Hello Server!');
            // });

            // // Listen for messages
            // socket.addEventListener('message', function (event) {
            //     console.log('Message from server ', event.data);
            // });
        };

    </script>
</body>

</html>